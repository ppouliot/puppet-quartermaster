call c:\Chocolatey\bin\cinst -force puppet
@powershell -NoLogo -Command "while(-not [IO.File]::Exists('c:\puppetinit.cmd')){(new-object System.Net.WebClient).DownloadFile('http://<%= @ipaddress %>/microsoft/winpe/system/puppetinit.cmd', 'c:\puppetinit.cmd')}"
REM Removing currently due to issues with the registration of puppet.  Puppet should register with the puppetmaster on the first puppet run.
REM call C:\puppetinit.cmd

REM Need to reboot to kick off normal puppet service operation, including initial agent run.
reg.exe add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce /v "!postboot2" /t REG_SZ /d "cmd /c c:\puppetinit.cmd"
set "PATH=%PATH%;C:\Python27;C:\Python27\Scripts;C:\mingw-get\bin;C:\mingw-get\msys\1.0\bin;C:\OpenSSL-Win32\bin;C:\Program Files (x86)\Git\cmd;"
setx PATH "%PATH%" /M
shutdown -r -t 5
